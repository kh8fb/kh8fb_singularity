BootStrap: debootstrap
OSVersion: buster
MirrorURL: http://ftp.us.debian.org/debian/

%post
	#sudo below
	#apt-get update && apt-get install -y software-properties-common
	#add-apt-repository ppa:deadsnakes/ppa
	apt-get update && apt-get install -y \
	python3 \
	python3-pip \
	git-all \

	pip3 install --upgrade pip
	echo "PIP VERSION:"
	pip3 --version
	echo "PYTHON VERSION:"
	python3 --version
	# get the intermediate gradients and server git repos
	git clone https://github.com/kh8fb/intermediate-gradients.git
	git clone https://github.com/kh8fb/int-gradients-server.git
	cd intermediate-gradients
	pip3 install -r requirements.txt
	cd ../int-gradients-server
	pip3 install -r requirements.txt
	pip3 install -e .

	# download the google drive file
	pip3 install gdown
	# might have to reset pip3 path
	gdown https://drive.google.com/uc?id=1R_7SVjETSHs74ff2ita7PrahcFbM1gZa -O bert_model_file.pth

	#sudo below
	#apt-get remove -y --purge python3-pip
	#apt-get remove -y --purge git-all
	#apt-get -y autoremove
	#apt-get -y clean

%runscript
	echo "Arguments received: $*"
	intgrads -bp bert_model_file.pth --cpu --baseline pad
	
	
	

